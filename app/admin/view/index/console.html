<include file="/public/header"/>
<script src="__STATICADMIN__module/echarts/echarts.js?console"></script>
<style>

    .layui-row {
        overflow: hidden;
        margin-bottom: 10px;
    }


    .layui-table {
        height: 250px;
    }

    .layui-table tr {
        cursor: pointer;
    }

    .task .layui-table td {
        white-space: nowrap;
        max-width: 120px;
    }

    .layui-table[lay-skin="nob"] th, .layui-table[lay-skin="nob"] td {
        white-space: nowrap;
        max-width: 50px;
        overflow: hidden;
    }

    ul.layui-timeline {
        height: 260px;
        overflow: hidden;
    }

    ul.layui-timeline:hover {
        overflow-y: auto;
    }

    .layui-carousel {
        height: 260px;
    }

    .layui-carousel > [carousel-item] > * {
        background: 0 0;
    }


    .layui-carousel > [carousel-item]:before {
        content: '';
    }

    /** å°ç»„æˆå‘˜ */
    .console-user-group {
        position: relative;
        padding: 10px 0 10px 60px;
    }

    .console-user-group .console-user-group-head {
        width: 32px;
        height: 32px;
        position: absolute;
        top: 50%;
        left: 12px;
        margin-top: -16px;
        border-radius: 50%;
    }

    .console-user-group .layui-badge {
        position: absolute;
        top: 50%;
        right: 8px;
        margin-top: -10px;
    }

    .console-user-group .console-user-group-name {
        line-height: 1.2;
    }

    .console-user-group .console-user-group-desc {
        color: #8c8c8c;
        line-height: 1;
        font-size: 12px;
        margin-top: 5px;
    }

    @media screen and (max-width: 1200px) {
        .layui-admin-workplace {
            margin: 0 8px 0px 1px;
        }
    }

    .item_d {
        width: 48%;
        color: #666;
        line-height: 25px;
        display: inline-block;
        padding: 5px 0;
        background: #f8f8f8;
        border-radius: 3px;
        cursor: pointer;
        margin: 6px 4px;
    }

    .item_d:hover {
        background: #eee;
    }

    .item_d .item_ico {
        height: 25px;
        margin-left: 10px;
    }

    .item_d span.count {
        color: #999;
        margin-right: 10px;
        float: right;
    }

    .spiderOrder {
        margin-right: 10px;
    }


    .spiderOrder:hover, .active {
        color: red;
    }

    .count {
        font-weight: bold;
        margin-left: 5px;
    }

</style>

<div class="layui-fluid ">

    <div class="layui-row layui-col-space10">

        <div class="layui-col-md8">
            <!-- å¡«å……å†…å®¹ -->
            <div class="layui-card">
                <div class="layui-card-body" style="padding: 20px;">
                    <div class="layui-row">
                        <div class="layui-col-md8">
                            <img src="{$AdminLogin.face}" class="layui-admin-avatar">
                            <div class="layui-admin-content">
                                <span class="h4">æ—©å®‰ï¼Œ{$AdminLogin.nickname|default=$AdminLogin.name}ï¼Œå¼€å§‹æ‚¨ä¸€å¤©çš„å·¥ä½œå§ï¼</span>
                                <span>ä»Šæ—¥å¤šäº‘è½¬é˜´ï¼Œ18â„ƒ - 22â„ƒï¼Œå‡ºé—¨è®°å¾—ç©¿å¤–å¥—å“¦~</span>
                            </div>
                        </div>
                        <div class="layui-col-md4">
                            <div class="layui-admin-workplace">
                                <div class="workplace-header">
                                    <span><i class="layui-icon layui-icon-list"></i>é€šçŸ¥</span>
                                </div>
                                <div class="workplace-content">{$workplace.notice|default=26}</div>
                            </div>

                            <div class="layui-admin-workplace">
                                <div class="workplace-header">
                                    <span><i class="layui-icon layui-icon-date date"></i>å¾…åŠé¡¹</span>
                                </div>
                                <div class="workplace-content">{$todoList}/{$workplace.todo}</div>
                            </div>
                            <div class="layui-admin-workplace">
                                <div class="workplace-header">
                                    <span><i class="layui-icon layui-icon-notice notice"></i>æ¶ˆæ¯</span>
                                </div>
                                <div class="workplace-content">{$workplace.message|default="2,352"}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="layui-col-md4">
            <div class="layui-card">
                <div class="layui-card-body" style="padding: 20px;">
                    <div style="height: 78px">
                        <ul>
                            <a href="javascript:;" class="workplace-action" sa-event="tabs"
                               data-url="{:url('/system.Attachment/index')}"
                               title="é™„ä»¶ç®¡ç†">é™„ä»¶ç®¡ç†</a>
                            <a href="javascript:;" class="workplace-action" sa-event="tabs"
                               data-url="{:url('/system.dictionary/index')}"
                               title="å­—å…¸ç®¡ç†">å­—å…¸ç®¡ç†</a>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="layui-row layui-col-space10" style="margin-bottom: 0;">

        <div class="layui-col-md4">
            <div class="layui-row layui-col-space10" style="margin-bottom: 5px;">
                <div class="layui-col-xs6 layui-col-sm6">
                    <div class="layui-card smallblock" sa-event="tabs" data-url="{:url('/system.Admin/center')}"
                         data-title="{:__('ç”¨æˆ·ä¸­å¿ƒ')}">
                        <div class="layui-card-body">
                            <div class="layui-small-block">
                                <div><i class="layui-icon layui-icon-user"></i></div>
                                <div class="layui-small-block-title">ç”¨æˆ·</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-col-xs6 layui-col-sm6">
                    <div class="layui-card smallblock" sa-event="tabs" data-url="{:url('/system.AdminNotice/index')}"
                         data-title="{:__('æ¶ˆæ¯ä¸­å¿ƒ')}">
                        <div class="layui-card-body">
                            <div class="layui-small-block">
                                <div><i class="layui-icon layui-icon-chart " style="color: #b0e689"></i></div>
                                <div class="layui-small-block-title">æ¶ˆæ¯</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-col-md4">
            <div class="layui-row layui-col-space10" style="margin-bottom: 5px;">
                <div class="layui-col-xs6 layui-col-sm6">
                    <div class="layui-card smallblock" sa-event="tabs" data-url="{:url('/system.Attachment/index')}"
                         data-title="{:__('é™„ä»¶ç®¡ç†')}">
                        <div class="layui-card-body">
                            <div class="layui-small-block">
                                <div><i class="layui-icon layui-icon-chart-screen" style="color: #fe9c6e"></i></div>
                                <div class="layui-small-block-title">é™„ä»¶</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-col-xs6 layui-col-sm6">
                    <div class="layui-card smallblock" sa-event="tabs" data-url="{:url('/system.Dictionary/index')}"
                         data-title="{:__('å­—å…¸ç®¡ç†')}">
                        <div class="layui-card-body">
                            <div class="layui-small-block">
                                <div><i class="layui-icon layui-icon-template-1" style="color: #b37eeb"></i></div>
                                <div class="layui-small-block-title">å­—å…¸</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-col-md4">
            <div class="layui-row layui-col-space10" style="margin-bottom: 5px;">
                <div class="layui-col-xs6 layui-col-sm6">
                    <div class="layui-card smallblock" sa-event="tabs" data-url="{:url('/system.SystemLog/index')}"
                         data-title="{:__('æ“ä½œæ—¥å¿—')}">
                        <div class="layui-card-body">
                            <div class="layui-small-block">
                                <div><i class="layui-icon layui-icon-list" style="color: #88e4de"></i></div>
                                <div class="layui-small-block-title">æ—¥å¿—</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-col-xs6 layui-col-sm6">
                    <div class="layui-card smallblock" sa-event="tabs" data-url="{:url('/index/basecfg')}"
                         data-title="{:__('åŸºæœ¬è®¾ç½®')}">
                        <div class="layui-card-body">
                            <div class="layui-small-block">
                                <div><i class="layui-icon layui-icon-set-sm" style="color: #ffc069"></i></div>
                                <div class="layui-small-block-title">è®¾ç½®</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="layui-row layui-col-space10">

        <div class="layui-col-md4">
            <div class="layui-card">
                <div class="layui-card-header">ä»Šæ—¥èœ˜è››ç»Ÿè®¡</div>
                <div style="height: 280px">
                    <table style="width:100%;" >
                        <tbody>
                        <tr>
                            <td colspan="2" style="padding: 10px;">
                                <div class="inbox">
                                    <div class="item_d">
                                        <img src="/static/images/spider/BaiduSpider.ico" class="item_ico">
                                        <span>ç™¾åº¦</span>
                                        <span class="count" id="BaiduSpider">{$spiderLogCount.BaiduSpider|default=0}</span>
                                    </div>
                                    <div class="item_d">
                                        <img src="/static/images/spider/Googlebot.ico" class="item_ico">
                                        <span>Google</span>
                                        <span class="count" id="Googlebot">{$spiderLogCount.Googlebot|default=0}</span>
                                    </div>
                                </div>
                                <div class="inbox">
                                    <div class="item_d">
                                        <img src="/static/images/spider/360Spider.ico" class="item_ico">
                                        <span>360èœ˜è››</span>
                                        <span class="count" id="360Spider">{$spiderLogCount.360Spider|default=0}</span>
                                    </div>
                                    <div class="item_d">
                                        <img src="/static/images/spider/Sogou.ico" class="item_ico">
                                        <span>æœç‹—</span>
                                        <span class="count" id="Sogou">{$spiderLogCount.Sogou|default=0}</span>
                                    </div>
                                </div>
                                <div class="inbox">
                                    <div class="item_d">
                                        <img src="/static/images/spider/YisouSpider.ico" class="item_ico">
                                        <span>ç¥é©¬</span>
                                        <span class="count" id="YisouSpider">{$spiderLogCount.YisouSpider|default=0}</span>
                                    </div>
                                    <div class="item_d">
                                        <img src="/static/images/spider/ByteSpider.ico" class="item_ico">
                                        <span>ä»Šæ—¥å¤´æ¡</span>
                                        <span class="count" id="ByteSpider">{$spiderLogCount.ByteSpider|default=0}</span>
                                    </div>
                                </div>
                                <div class="inbox">
                                    <div class="item_d">
                                        <img src="/static/images/spider/BingBot.ico" class="item_ico">
                                        <span>å¾®è½¯bing</span>
                                        <span class="count" id="BingBot">{$spiderLogCount.BingBot|default=0}</span>
                                    </div>
                                    <div class="item_d">
                                        <img src="/static/images/spider/YandexBot.ico" class="item_ico">
                                        <span>Yandex</span>
                                        <span class="count" id="YandexBot">{$spiderLogCount.YandexBot|default=0}</span>
                                    </div>
                                </div>
                                <div class="inbox">
                                    <div class="item_d">
                                        <img src="" class="item_ico">
                                        <span>ğŸ· æ€»èœ˜è››</span>
                                        <span class="count" >{$spiderCount|default=0}</span>
                                    </div>

                                    <div class="item_d" sa-event="tabs" data-url="{:url('/system.Spider/index')}" data-title="èœ˜è››åˆ†æ">
                                        <img src="" class="item_ico">
                                        <span>ğŸ•¸ï¸ èœ˜è››åˆ†æ</span>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="layui-col-md8">
            <div class="layui-card">
                <div class="layui-card-header">èœ˜è››æ—¶æ•ˆç»Ÿè®¡è¡¨</div>
                <div class="layui-card-body">
                    <div class="layui-center">
                        <a class="spiderOrder active" data-cycle="today">ä»Šå¤©<span class="count">({$spiderDayCount.today})</span></a>
                        <a class="spiderOrder" data-cycle="yesterday">æ˜¨å¤©<span class="count">({$spiderDayCount.yesterday})</span></a>
                        <a class="spiderOrder" data-cycle="beforeYesterday">å‰å¤©<span class="count">({$spiderDayCount.beforeYesterday})</span></a>
                    </div>
                    <div id="spiderHoursCharts" style="height: 235px;"></div>
                    <div id="spiderHoursData" style="display: none">{$spiderHoursData|raw}</div>

                </div>
            </div>
        </div>

    </div>
</div>
<script src="__STATICADMIN__module/echarts/echarts.js"></script>
<script src="__STATICADMIN__module/echarts/echarts-wordcloud.js"></script>
<script src="__STATICADMIN__module/echarts/china.js"></script>
<include file="/public/footer"/>

<script>

    layui.use(['show','carousel','layer'], function () {

        let $ = layui.jquery; let show = layui.show;
        var layer = layui.layer;
        var carousel = layui.carousel;

        //å»ºé€ å®ä¾‹
        carousel.render({
            elem: '#carousel'
            , width: '100%' //è®¾ç½®å®¹å™¨å®½åº¦
            , arrow: 'none' //å§‹ç»ˆæ˜¾ç¤ºç®­å¤´
        });
        
        var spiderHoursCharts = echarts.init(document.getElementById('spiderHoursCharts'));
        var getSpiderOptions = function (xAxisData, seriesData) {
            return {
                color: ['#1890ff', '#666'],
                tooltip: {
                    trigger: "axis"
                },
                xAxis: [{
                    type: "category",
                    boundaryGap: !1,
                    data: xAxisData
                }],
                yAxis: [{
                    type: "value"
                }],
                grid: {
                    x: 38,
                    y: 15,
                    x2: 18,
                    y2: 35,
                    borderWidth: 1,
                },
                series: [{
                    name: "èœ˜è››è®¿é—®æ¬¡æ•°ï¼ˆæ¬¡/å°æ—¶ï¼‰",
                    type: "line",
                    smooth: !0,
                    itemStyle: {
                        normal: {
                            areaStyle: {
                                type: "default"
                            }
                        }
                    },
                    data: seriesData
                }]
            };
        }
        var spiderHoursData = JSON.parse($('#spiderHoursData').text());
        var spiderOptions = getSpiderOptions(spiderHoursData.xAxisData, spiderHoursData.seriesData);
        spiderHoursCharts.setOption(spiderOptions);
        /**
         * æŸ¥è¯¢æ³¨å†ŒæŠ¥è¡¨
         * @param page
         */
        $('.spiderOrder').click(function (e) {
            let that = $(this);
            let cycle = $(this).data('cycle');
            $.ajax({
                url: '{:url("/system.Spider/hours")}',
                type: 'post',
                data: {cycle: cycle},
                dataType: 'json',
                success: function (res) {
                    if (res.code === 200) {
                        // æ¸²æŸ“å›¾è¡¨
                        let spiderHoursData = res.data.spiderHoursData;
                        let spiderOptions = getSpiderOptions(spiderHoursData.xAxisData, spiderHoursData.seriesData);
                        spiderHoursCharts.setOption(spiderOptions);

                        // é‡è½½æ•°æ®
                        let spiderLogCount = res.data.spiderLogCount;
                        for (const key in spiderLogCount) {
                            $('#'+key).text(spiderLogCount[key]);
                        }
                        $('.spiderOrder').removeClass('active');
                        $(that).addClass('active');
                    } else {
                        layer.info(res.msg);
                    }
                }
            })
        })

        // çª—å£å¤§å°æ”¹å˜äº‹ä»¶
        window.onresize = function () {
            spiderHoursCharts.resize();
        };
    })

</script>
</body>
</html>
